<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction – Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ff4371ef257df69894857e99c6ad0d06.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-dec4957386d03255e1655963b31d62d3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-530bf8e59df25186f8bffdc63bad3503.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-bd21be224d3c18e074efcd5cf41426bc.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-netflix-titles-covid-comparison" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Netflix titles COVID Comparison</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-netflix-titles-covid-comparison">    
        <li>
    <a class="dropdown-item" href="../index.html">
 <span class="dropdown-text">Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis.html">
 <span class="dropdown-text">Visualization &amp; Analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/aravindsankars/myData_Analysis" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structure-of-the-project" id="toc-structure-of-the-project" class="nav-link active" data-scroll-target="#structure-of-the-project">Structure of the Project:</a></li>
  <li><a href="#data-preparation-for-tmdb-and-netflix-titles" id="toc-data-preparation-for-tmdb-and-netflix-titles" class="nav-link" data-scroll-target="#data-preparation-for-tmdb-and-netflix-titles">Data Preparation for TMDB and Netflix Titles</a></li>
  <li><a href="#pre-covid-netflix-titles-with-tmdb" id="toc-pre-covid-netflix-titles-with-tmdb" class="nav-link" data-scroll-target="#pre-covid-netflix-titles-with-tmdb">Pre Covid Netflix titles with TMDB</a>
  <ul class="collapse">
  <li><a href="#loading-and-inspecting-datasets" id="toc-loading-and-inspecting-datasets" class="nav-link" data-scroll-target="#loading-and-inspecting-datasets">1. Loading and Inspecting Datasets</a></li>
  <li><a href="#data-cleaning-and-transformation" id="toc-data-cleaning-and-transformation" class="nav-link" data-scroll-target="#data-cleaning-and-transformation">2. Data Cleaning and Transformation</a></li>
  <li><a href="#merging-datasets" id="toc-merging-datasets" class="nav-link" data-scroll-target="#merging-datasets">3. Merging Datasets</a></li>
  <li><a href="#statistics-and-identifying-common-titles" id="toc-statistics-and-identifying-common-titles" class="nav-link" data-scroll-target="#statistics-and-identifying-common-titles">4. Statistics and Identifying Common Titles</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The impact of COVID-19 has been profound across industries, and the entertainment field is no exception. As someone with a long-standing interest in movies and a curiosity about Netflix’s business strategy, I was particularly intrigued by how the streaming giant adapted its content library in response to the pandemic. This project is an effort to explore the changes in Netflix’s movie catalog by comparing data from the pre-COVID and post-COVID periods.</p>
<p>To enrich the analysis, I incorporated data from the TMDB dataset, which provides extensive information about movies, such as genres, popularity, and release years. By connecting Netflix’s pre- and post-COVID datasets with TMDB, I aim to identify patterns, shifts, and trends in Netflix’s content strategy.</p>
<section id="structure-of-the-project" class="level3">
<h3 class="anchored" data-anchor-id="structure-of-the-project">Structure of the Project:</h3>
<p><strong>Data Preparation for TMDB and Netflix Titles:</strong></p>
<p>The first step involved processing datasets from Netflix and TMDB to ensure consistency and quality. Titles were standardized, duplicates were removed, and pre- and post-COVID Netflix datasets were merged with the TMDB dataset through an inner join to include only matching titles. This phase focused on producing cleaned datasets that would serve as a foundation for reliable analysis.</p>
<p><strong>Analysis and Visualization:</strong></p>
<p>The second phase involved analyzing the prepared datasets to uncover insights about Netflix’s content strategy before and after COVID-19. Using visualizations, I explored trends such as the distribution of movies by genre, release year, and popularity, comparing pre- and post-COVID periods. The findings highlight shifts in Netflix’s catalog and provide a deeper understanding of its response to changing consumer needs during and after the pandemic.</p>
<p>This project combines my passion for movies and data analysis to uncover meaningful insights into Netflix’s evolving content strategy, with a focus on how the pandemic influenced its movie library.</p>
</section>
<section id="data-preparation-for-tmdb-and-netflix-titles" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-for-tmdb-and-netflix-titles">Data Preparation for TMDB and Netflix Titles</h2>
<p>This notebook processes datasets from Netflix and TMDB to identify matching titles, explore statistics, and generate cleaned outputs. Each step is documented to ensure clarity and reproducibility.</p>
</section>
<section id="pre-covid-netflix-titles-with-tmdb" class="level2">
<h2 class="anchored" data-anchor-id="pre-covid-netflix-titles-with-tmdb">Pre Covid Netflix titles with TMDB</h2>
<section id="loading-and-inspecting-datasets" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-inspecting-datasets">1. Loading and Inspecting Datasets</h3>
<div id="17214194" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pre_netflix_df <span class="op">=</span> pd.read_csv(<span class="st">'PreCovid_titles.csv'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>tmdb_df <span class="op">=</span> pd.read_csv(<span class="st">'TMDB_movie_dataset_v11.csv'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>post_netflix_df <span class="op">=</span> pd.read_csv(<span class="st">'PostCovid_titles_May2022.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I have displayed the shapes and a few titles from each dataset below. First one is pre-COVID dataset.</p>
<div id="acf15643-8073-4030-9b6b-08648aa11afa" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Netflix Pre-COVID dataset shape:'</span>, pre_netflix_df.shape)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pre_netflix_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Netflix Pre-COVID dataset shape: (6234, 12)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="111">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">show_id</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">director</th>
<th data-quarto-table-cell-role="th">cast</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date_added</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">listed_in</th>
<th data-quarto-table-cell-role="th">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>81145628</td>
<td>Movie</td>
<td>Norm of the North: King Sized Adventure</td>
<td>Richard Finn, Tim Maltby</td>
<td>Alan Marriott, Andrew Toth, Brian Dobson, Cole...</td>
<td>United States, India, South Korea, China</td>
<td>September 9, 2019</td>
<td>2019</td>
<td>TV-PG</td>
<td>90 min</td>
<td>Children &amp; Family Movies, Comedies</td>
<td>Before planning an awesome wedding for his gra...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>80117401</td>
<td>Movie</td>
<td>Jandino: Whatever it Takes</td>
<td>NaN</td>
<td>Jandino Asporaat</td>
<td>United Kingdom</td>
<td>September 9, 2016</td>
<td>2016</td>
<td>TV-MA</td>
<td>94 min</td>
<td>Stand-Up Comedy</td>
<td>Jandino Asporaat riffs on the challenges of ra...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>70234439</td>
<td>TV Show</td>
<td>Transformers Prime</td>
<td>NaN</td>
<td>Peter Cullen, Sumalee Montano, Frank Welker, J...</td>
<td>United States</td>
<td>September 8, 2018</td>
<td>2013</td>
<td>TV-Y7-FV</td>
<td>1 Season</td>
<td>Kids' TV</td>
<td>With the help of three human allies, the Autob...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>80058654</td>
<td>TV Show</td>
<td>Transformers: Robots in Disguise</td>
<td>NaN</td>
<td>Will Friedle, Darren Criss, Constance Zimmer, ...</td>
<td>United States</td>
<td>September 8, 2018</td>
<td>2016</td>
<td>TV-Y7</td>
<td>1 Season</td>
<td>Kids' TV</td>
<td>When a prison ship crash unleashes hundreds of...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>80125979</td>
<td>Movie</td>
<td>#realityhigh</td>
<td>Fernando Lebrija</td>
<td>Nesta Cooper, Kate Walsh, John Michael Higgins...</td>
<td>United States</td>
<td>September 8, 2017</td>
<td>2017</td>
<td>TV-14</td>
<td>99 min</td>
<td>Comedies</td>
<td>When nerdy high schooler Dani finally attracts...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now, the TMDB dataset.</p>
<div id="84fe8b52-352b-45f8-a33a-c217207cce0e" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'TMDB dataset shape:'</span>, tmdb_df.shape)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tmdb_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TMDB dataset shape: (1147541, 24)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="113">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">vote_average</th>
<th data-quarto-table-cell-role="th">vote_count</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">release_date</th>
<th data-quarto-table-cell-role="th">revenue</th>
<th data-quarto-table-cell-role="th">runtime</th>
<th data-quarto-table-cell-role="th">adult</th>
<th data-quarto-table-cell-role="th">backdrop_path</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">original_title</th>
<th data-quarto-table-cell-role="th">overview</th>
<th data-quarto-table-cell-role="th">popularity</th>
<th data-quarto-table-cell-role="th">poster_path</th>
<th data-quarto-table-cell-role="th">tagline</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">production_companies</th>
<th data-quarto-table-cell-role="th">production_countries</th>
<th data-quarto-table-cell-role="th">spoken_languages</th>
<th data-quarto-table-cell-role="th">keywords</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>27205</td>
<td>Inception</td>
<td>8.364</td>
<td>34495</td>
<td>Released</td>
<td>2010-07-15</td>
<td>825532764</td>
<td>148</td>
<td>False</td>
<td>/8ZTVqvKDQ8emSGUEMjsS4yHAwrp.jpg</td>
<td>...</td>
<td>Inception</td>
<td>Cobb, a skilled thief who commits corporate es...</td>
<td>83.952</td>
<td>/oYuLEt3zVCKq57qu2F8dT7NIa6f.jpg</td>
<td>Your mind is the scene of the crime.</td>
<td>Action, Science Fiction, Adventure</td>
<td>Legendary Pictures, Syncopy, Warner Bros. Pict...</td>
<td>United Kingdom, United States of America</td>
<td>English, French, Japanese, Swahili</td>
<td>rescue, mission, dream, airplane, paris, franc...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>157336</td>
<td>Interstellar</td>
<td>8.417</td>
<td>32571</td>
<td>Released</td>
<td>2014-11-05</td>
<td>701729206</td>
<td>169</td>
<td>False</td>
<td>/pbrkL804c8yAv3zBZR4QPEafpAR.jpg</td>
<td>...</td>
<td>Interstellar</td>
<td>The adventures of a group of explorers who mak...</td>
<td>140.241</td>
<td>/gEU2QniE6E77NI6lCU6MxlNBvIx.jpg</td>
<td>Mankind was born on Earth. It was never meant ...</td>
<td>Adventure, Drama, Science Fiction</td>
<td>Legendary Pictures, Syncopy, Lynda Obst Produc...</td>
<td>United Kingdom, United States of America</td>
<td>English</td>
<td>rescue, future, spacecraft, race against time,...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>155</td>
<td>The Dark Knight</td>
<td>8.512</td>
<td>30619</td>
<td>Released</td>
<td>2008-07-16</td>
<td>1004558444</td>
<td>152</td>
<td>False</td>
<td>/nMKdUUepR0i5zn0y1T4CsSB5chy.jpg</td>
<td>...</td>
<td>The Dark Knight</td>
<td>Batman raises the stakes in his war on crime. ...</td>
<td>130.643</td>
<td>/qJ2tW6WMUDux911r6m7haRef0WH.jpg</td>
<td>Welcome to a world without rules.</td>
<td>Drama, Action, Crime, Thriller</td>
<td>DC Comics, Legendary Pictures, Syncopy, Isobel...</td>
<td>United Kingdom, United States of America</td>
<td>English, Mandarin</td>
<td>joker, sadism, chaos, secret identity, crime f...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>19995</td>
<td>Avatar</td>
<td>7.573</td>
<td>29815</td>
<td>Released</td>
<td>2009-12-15</td>
<td>2923706026</td>
<td>162</td>
<td>False</td>
<td>/vL5LR6WdxWPjLPFRLe133jXWsh5.jpg</td>
<td>...</td>
<td>Avatar</td>
<td>In the 22nd century, a paraplegic Marine is di...</td>
<td>79.932</td>
<td>/kyeqWdyUXW608qlYkRqosgbbJyK.jpg</td>
<td>Enter the world of Pandora.</td>
<td>Action, Adventure, Fantasy, Science Fiction</td>
<td>Dune Entertainment, Lightstorm Entertainment, ...</td>
<td>United States of America, United Kingdom</td>
<td>English, Spanish</td>
<td>future, society, culture clash, space travel, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24428</td>
<td>The Avengers</td>
<td>7.710</td>
<td>29166</td>
<td>Released</td>
<td>2012-04-25</td>
<td>1518815515</td>
<td>143</td>
<td>False</td>
<td>/9BBTo63ANSmhC4e6r62OJFuK2GL.jpg</td>
<td>...</td>
<td>The Avengers</td>
<td>When an unexpected enemy emerges and threatens...</td>
<td>98.082</td>
<td>/RYMX2wcKCBAr24UyPD7xwmjaTn.jpg</td>
<td>Some assembly required.</td>
<td>Science Fiction, Action, Adventure</td>
<td>Marvel Studios</td>
<td>United States of America</td>
<td>English, Hindi, Russian</td>
<td>new york city, superhero, shield, based on com...</td>
</tr>
</tbody>
</table>

<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<p>Finally, the post-COVID dataset.</p>
<div id="0d90d603-239b-4e2d-ba0c-9e86744496da" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Netflix post-COVID dataset shape:'</span>, post_netflix_df.shape)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>post_netflix_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Netflix post-COVID dataset shape: (5806, 15)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="115">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">age_certification</th>
<th data-quarto-table-cell-role="th">runtime</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">production_countries</th>
<th data-quarto-table-cell-role="th">seasons</th>
<th data-quarto-table-cell-role="th">imdb_id</th>
<th data-quarto-table-cell-role="th">imdb_score</th>
<th data-quarto-table-cell-role="th">imdb_votes</th>
<th data-quarto-table-cell-role="th">tmdb_popularity</th>
<th data-quarto-table-cell-role="th">tmdb_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ts300399</td>
<td>Five Came Back: The Reference Films</td>
<td>SHOW</td>
<td>This collection includes 12 World War II-era p...</td>
<td>1945</td>
<td>TV-MA</td>
<td>48</td>
<td>['documentation']</td>
<td>['US']</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.600</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>tm84618</td>
<td>Taxi Driver</td>
<td>MOVIE</td>
<td>A mentally unstable Vietnam War veteran works ...</td>
<td>1976</td>
<td>R</td>
<td>113</td>
<td>['crime', 'drama']</td>
<td>['US']</td>
<td>NaN</td>
<td>tt0075314</td>
<td>8.3</td>
<td>795222.0</td>
<td>27.612</td>
<td>8.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>tm127384</td>
<td>Monty Python and the Holy Grail</td>
<td>MOVIE</td>
<td>King Arthur, accompanied by his squire, recrui...</td>
<td>1975</td>
<td>PG</td>
<td>91</td>
<td>['comedy', 'fantasy']</td>
<td>['GB']</td>
<td>NaN</td>
<td>tt0071853</td>
<td>8.2</td>
<td>530877.0</td>
<td>18.216</td>
<td>7.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>tm70993</td>
<td>Life of Brian</td>
<td>MOVIE</td>
<td>Brian Cohen is an average young Jewish man, bu...</td>
<td>1979</td>
<td>R</td>
<td>94</td>
<td>['comedy']</td>
<td>['GB']</td>
<td>NaN</td>
<td>tt0079470</td>
<td>8.0</td>
<td>392419.0</td>
<td>17.505</td>
<td>7.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>tm190788</td>
<td>The Exorcist</td>
<td>MOVIE</td>
<td>12-year-old Regan MacNeil begins to adapt an e...</td>
<td>1973</td>
<td>R</td>
<td>133</td>
<td>['horror']</td>
<td>['US']</td>
<td>NaN</td>
<td>tt0070047</td>
<td>8.1</td>
<td>391942.0</td>
<td>95.337</td>
<td>7.7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-cleaning-and-transformation" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-and-transformation">2. Data Cleaning and Transformation</h3>
<p>The data cleaning and transformation steps for the source datasets are standardizing title case to lowercase and dropping duplicates in datasets.</p>
<p>Titles in the datasets may have case differences (e.g., “Inception” vs.&nbsp;“inception”), which would otherwise be treated as distinct entries. Converting titles to lowercase standardizes them for consistent comparison and duplicate removal.</p>
<div id="237ee67e-45d0-4dd1-aa08-1780e000d442" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pre_netflix_df[<span class="st">'title_lower'</span>] <span class="op">=</span> pre_netflix_df[<span class="st">'title'</span>].<span class="bu">str</span>.lower()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tmdb_df[<span class="st">'title_lower'</span>] <span class="op">=</span> tmdb_df[<span class="st">'title'</span>].<span class="bu">str</span>.lower()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>post_netflix_df[<span class="st">'title_lower'</span>] <span class="op">=</span> post_netflix_df[<span class="st">'title'</span>].<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Duplicate titles can distort analysis and inflate metrics. Removing duplicates ensures the data reflects unique entries, leading to cleaner and more accurate insights.</p>
<div id="90a710b1" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pre_netflix_df <span class="op">=</span> pre_netflix_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'title_lower'</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Netflix Pre-COVID dataset shape:'</span>, pre_netflix_df.shape)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pre_netflix_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Netflix Pre-COVID dataset shape: (6169, 13)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="121">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">show_id</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">director</th>
<th data-quarto-table-cell-role="th">cast</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date_added</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">listed_in</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">title_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>81145628</td>
<td>Movie</td>
<td>Norm of the North: King Sized Adventure</td>
<td>Richard Finn, Tim Maltby</td>
<td>Alan Marriott, Andrew Toth, Brian Dobson, Cole...</td>
<td>United States, India, South Korea, China</td>
<td>September 9, 2019</td>
<td>2019</td>
<td>TV-PG</td>
<td>90 min</td>
<td>Children &amp; Family Movies, Comedies</td>
<td>Before planning an awesome wedding for his gra...</td>
<td>norm of the north: king sized adventure</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>80117401</td>
<td>Movie</td>
<td>Jandino: Whatever it Takes</td>
<td>NaN</td>
<td>Jandino Asporaat</td>
<td>United Kingdom</td>
<td>September 9, 2016</td>
<td>2016</td>
<td>TV-MA</td>
<td>94 min</td>
<td>Stand-Up Comedy</td>
<td>Jandino Asporaat riffs on the challenges of ra...</td>
<td>jandino: whatever it takes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>70234439</td>
<td>TV Show</td>
<td>Transformers Prime</td>
<td>NaN</td>
<td>Peter Cullen, Sumalee Montano, Frank Welker, J...</td>
<td>United States</td>
<td>September 8, 2018</td>
<td>2013</td>
<td>TV-Y7-FV</td>
<td>1 Season</td>
<td>Kids' TV</td>
<td>With the help of three human allies, the Autob...</td>
<td>transformers prime</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>80058654</td>
<td>TV Show</td>
<td>Transformers: Robots in Disguise</td>
<td>NaN</td>
<td>Will Friedle, Darren Criss, Constance Zimmer, ...</td>
<td>United States</td>
<td>September 8, 2018</td>
<td>2016</td>
<td>TV-Y7</td>
<td>1 Season</td>
<td>Kids' TV</td>
<td>When a prison ship crash unleashes hundreds of...</td>
<td>transformers: robots in disguise</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>80125979</td>
<td>Movie</td>
<td>#realityhigh</td>
<td>Fernando Lebrija</td>
<td>Nesta Cooper, Kate Walsh, John Michael Higgins...</td>
<td>United States</td>
<td>September 8, 2017</td>
<td>2017</td>
<td>TV-14</td>
<td>99 min</td>
<td>Comedies</td>
<td>When nerdy high schooler Dani finally attracts...</td>
<td>#realityhigh</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b260db70-1771-46ba-b57e-778c6b94e23a" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tmdb_df <span class="op">=</span> tmdb_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'title_lower'</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'TMDB dataset shape:'</span>, tmdb_df.shape)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>tmdb_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TMDB dataset shape: (973912, 25)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">vote_average</th>
<th data-quarto-table-cell-role="th">vote_count</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">release_date</th>
<th data-quarto-table-cell-role="th">revenue</th>
<th data-quarto-table-cell-role="th">runtime</th>
<th data-quarto-table-cell-role="th">adult</th>
<th data-quarto-table-cell-role="th">backdrop_path</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">overview</th>
<th data-quarto-table-cell-role="th">popularity</th>
<th data-quarto-table-cell-role="th">poster_path</th>
<th data-quarto-table-cell-role="th">tagline</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">production_companies</th>
<th data-quarto-table-cell-role="th">production_countries</th>
<th data-quarto-table-cell-role="th">spoken_languages</th>
<th data-quarto-table-cell-role="th">keywords</th>
<th data-quarto-table-cell-role="th">title_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>27205</td>
<td>Inception</td>
<td>8.364</td>
<td>34495</td>
<td>Released</td>
<td>2010-07-15</td>
<td>825532764</td>
<td>148</td>
<td>False</td>
<td>/8ZTVqvKDQ8emSGUEMjsS4yHAwrp.jpg</td>
<td>...</td>
<td>Cobb, a skilled thief who commits corporate es...</td>
<td>83.952</td>
<td>/oYuLEt3zVCKq57qu2F8dT7NIa6f.jpg</td>
<td>Your mind is the scene of the crime.</td>
<td>Action, Science Fiction, Adventure</td>
<td>Legendary Pictures, Syncopy, Warner Bros. Pict...</td>
<td>United Kingdom, United States of America</td>
<td>English, French, Japanese, Swahili</td>
<td>rescue, mission, dream, airplane, paris, franc...</td>
<td>inception</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>157336</td>
<td>Interstellar</td>
<td>8.417</td>
<td>32571</td>
<td>Released</td>
<td>2014-11-05</td>
<td>701729206</td>
<td>169</td>
<td>False</td>
<td>/pbrkL804c8yAv3zBZR4QPEafpAR.jpg</td>
<td>...</td>
<td>The adventures of a group of explorers who mak...</td>
<td>140.241</td>
<td>/gEU2QniE6E77NI6lCU6MxlNBvIx.jpg</td>
<td>Mankind was born on Earth. It was never meant ...</td>
<td>Adventure, Drama, Science Fiction</td>
<td>Legendary Pictures, Syncopy, Lynda Obst Produc...</td>
<td>United Kingdom, United States of America</td>
<td>English</td>
<td>rescue, future, spacecraft, race against time,...</td>
<td>interstellar</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>155</td>
<td>The Dark Knight</td>
<td>8.512</td>
<td>30619</td>
<td>Released</td>
<td>2008-07-16</td>
<td>1004558444</td>
<td>152</td>
<td>False</td>
<td>/nMKdUUepR0i5zn0y1T4CsSB5chy.jpg</td>
<td>...</td>
<td>Batman raises the stakes in his war on crime. ...</td>
<td>130.643</td>
<td>/qJ2tW6WMUDux911r6m7haRef0WH.jpg</td>
<td>Welcome to a world without rules.</td>
<td>Drama, Action, Crime, Thriller</td>
<td>DC Comics, Legendary Pictures, Syncopy, Isobel...</td>
<td>United Kingdom, United States of America</td>
<td>English, Mandarin</td>
<td>joker, sadism, chaos, secret identity, crime f...</td>
<td>the dark knight</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>19995</td>
<td>Avatar</td>
<td>7.573</td>
<td>29815</td>
<td>Released</td>
<td>2009-12-15</td>
<td>2923706026</td>
<td>162</td>
<td>False</td>
<td>/vL5LR6WdxWPjLPFRLe133jXWsh5.jpg</td>
<td>...</td>
<td>In the 22nd century, a paraplegic Marine is di...</td>
<td>79.932</td>
<td>/kyeqWdyUXW608qlYkRqosgbbJyK.jpg</td>
<td>Enter the world of Pandora.</td>
<td>Action, Adventure, Fantasy, Science Fiction</td>
<td>Dune Entertainment, Lightstorm Entertainment, ...</td>
<td>United States of America, United Kingdom</td>
<td>English, Spanish</td>
<td>future, society, culture clash, space travel, ...</td>
<td>avatar</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24428</td>
<td>The Avengers</td>
<td>7.710</td>
<td>29166</td>
<td>Released</td>
<td>2012-04-25</td>
<td>1518815515</td>
<td>143</td>
<td>False</td>
<td>/9BBTo63ANSmhC4e6r62OJFuK2GL.jpg</td>
<td>...</td>
<td>When an unexpected enemy emerges and threatens...</td>
<td>98.082</td>
<td>/RYMX2wcKCBAr24UyPD7xwmjaTn.jpg</td>
<td>Some assembly required.</td>
<td>Science Fiction, Action, Adventure</td>
<td>Marvel Studios</td>
<td>United States of America</td>
<td>English, Hindi, Russian</td>
<td>new york city, superhero, shield, based on com...</td>
<td>the avengers</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div id="0b22d835-4ec3-4a52-8da5-45fc80163bcb" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>post_netflix_df <span class="op">=</span> post_netflix_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'title_lower'</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Netflix Post-COVID dataset shape:'</span>, post_netflix_df.shape)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>post_netflix_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Netflix Post-COVID dataset shape: (5750, 16)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="123">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">age_certification</th>
<th data-quarto-table-cell-role="th">runtime</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">production_countries</th>
<th data-quarto-table-cell-role="th">seasons</th>
<th data-quarto-table-cell-role="th">imdb_id</th>
<th data-quarto-table-cell-role="th">imdb_score</th>
<th data-quarto-table-cell-role="th">imdb_votes</th>
<th data-quarto-table-cell-role="th">tmdb_popularity</th>
<th data-quarto-table-cell-role="th">tmdb_score</th>
<th data-quarto-table-cell-role="th">title_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ts300399</td>
<td>Five Came Back: The Reference Films</td>
<td>SHOW</td>
<td>This collection includes 12 World War II-era p...</td>
<td>1945</td>
<td>TV-MA</td>
<td>48</td>
<td>['documentation']</td>
<td>['US']</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.600</td>
<td>NaN</td>
<td>five came back: the reference films</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>tm84618</td>
<td>Taxi Driver</td>
<td>MOVIE</td>
<td>A mentally unstable Vietnam War veteran works ...</td>
<td>1976</td>
<td>R</td>
<td>113</td>
<td>['crime', 'drama']</td>
<td>['US']</td>
<td>NaN</td>
<td>tt0075314</td>
<td>8.3</td>
<td>795222.0</td>
<td>27.612</td>
<td>8.2</td>
<td>taxi driver</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>tm127384</td>
<td>Monty Python and the Holy Grail</td>
<td>MOVIE</td>
<td>King Arthur, accompanied by his squire, recrui...</td>
<td>1975</td>
<td>PG</td>
<td>91</td>
<td>['comedy', 'fantasy']</td>
<td>['GB']</td>
<td>NaN</td>
<td>tt0071853</td>
<td>8.2</td>
<td>530877.0</td>
<td>18.216</td>
<td>7.8</td>
<td>monty python and the holy grail</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>tm70993</td>
<td>Life of Brian</td>
<td>MOVIE</td>
<td>Brian Cohen is an average young Jewish man, bu...</td>
<td>1979</td>
<td>R</td>
<td>94</td>
<td>['comedy']</td>
<td>['GB']</td>
<td>NaN</td>
<td>tt0079470</td>
<td>8.0</td>
<td>392419.0</td>
<td>17.505</td>
<td>7.8</td>
<td>life of brian</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>tm190788</td>
<td>The Exorcist</td>
<td>MOVIE</td>
<td>12-year-old Regan MacNeil begins to adapt an e...</td>
<td>1973</td>
<td>R</td>
<td>133</td>
<td>['horror']</td>
<td>['US']</td>
<td>NaN</td>
<td>tt0070047</td>
<td>8.1</td>
<td>391942.0</td>
<td>95.337</td>
<td>7.7</td>
<td>the exorcist</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The focus of my analysis is on movies. Removing TV shows ensures the dataset aligns with my analysis goal. Also, the number of TV shows is significantly lower compared to movies in both the datasets, further justifying the focus on movies.</p>
<div id="7acaec8b-a744-45aa-bd9a-8aeb6cfd621a" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop TV shows from pre_netflix_df </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pre_netflix_df <span class="op">=</span> pre_netflix_df[pre_netflix_df[<span class="st">'type'</span>] <span class="op">!=</span> <span class="st">"TV Show"</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pre_netflix_df.groupby(<span class="st">'type'</span>).count().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">show_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">director</th>
<th data-quarto-table-cell-role="th">cast</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date_added</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">listed_in</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">title_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Movie</td>
<td>4230</td>
<td>4230</td>
<td>4103</td>
<td>3873</td>
<td>4036</td>
<td>4230</td>
<td>4230</td>
<td>4223</td>
<td>4230</td>
<td>4230</td>
<td>4230</td>
<td>4230</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8ad34fe6-4dcb-45a7-b1de-45a1e60740e3" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop SHOW from post_netflix_df</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>post_netflix_df <span class="op">=</span> post_netflix_df[post_netflix_df[<span class="st">'type'</span>] <span class="op">!=</span> <span class="st">"SHOW"</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>post_netflix_df.groupby(<span class="st">'type'</span>).count().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">age_certification</th>
<th data-quarto-table-cell-role="th">runtime</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">production_countries</th>
<th data-quarto-table-cell-role="th">seasons</th>
<th data-quarto-table-cell-role="th">imdb_id</th>
<th data-quarto-table-cell-role="th">imdb_score</th>
<th data-quarto-table-cell-role="th">imdb_votes</th>
<th data-quarto-table-cell-role="th">tmdb_popularity</th>
<th data-quarto-table-cell-role="th">tmdb_score</th>
<th data-quarto-table-cell-role="th">title_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MOVIE</td>
<td>3729</td>
<td>3728</td>
<td>3721</td>
<td>3729</td>
<td>1395</td>
<td>3729</td>
<td>3729</td>
<td>3729</td>
<td>0</td>
<td>3422</td>
<td>3378</td>
<td>3362</td>
<td>3671</td>
<td>3546</td>
<td>3728</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="merging-datasets" class="level3">
<h3 class="anchored" data-anchor-id="merging-datasets">3. Merging Datasets</h3>
<p>After cleaning the datasets by standardizing title cases to lowercase and removing duplicates, I merged the cleaned pre-COVID Netflix dataset and post-COVID Netflix dataset with the TMDB dataset. The merge was performed using an inner join on the standardized title column (title_lower). This approach ensures that only Netflix titles present in the TMDB dataset are included in the resulting merged datasets. The TMDB dataset contains additional information about titles, making it valuable for deeper analysis.</p>
<div id="b7fb728c" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge datasets on standardized title</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pre_merged_df <span class="op">=</span> pd.merge(pre_netflix_df, tmdb_df, on<span class="op">=</span><span class="st">'title_lower'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save pre merged dataset</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>pre_merged_df.to_csv(<span class="st">'pre_covid_merged_titles.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Pre-COVID Merged dataset shape: </span><span class="sc">{</span>pre_merged_df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pre-COVID Merged dataset shape: (3650, 37)</code></pre>
</div>
</div>
<p>For the post-COVID Netflix dataset, an additional filter was applied to include only titles with a release year greater than or equal to 2020, ensuring that only relevant post-COVID titles are retained. After filtering, the dataset was merged with the TMDB dataset similarly using an inner join.</p>
<div id="43f4165c-5e0c-4e61-b4b9-74385d603c8e" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter post-COVID titles (release year &gt;= 2020)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>post_merged_df <span class="op">=</span> post_netflix_df[post_netflix_df[<span class="st">'release_year'</span>] <span class="op">&gt;=</span> <span class="dv">2020</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>post_merged_df <span class="op">=</span> pd.merge(post_netflix_df, tmdb_df, on<span class="op">=</span><span class="st">'title_lower'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Save post-COVID merged dataset</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>post_merged_df.to_csv(<span class="st">'post_covid_merged_titles.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Post-COVID merged dataset shape: </span><span class="sc">{</span>post_merged_df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Post-COVID merged dataset shape: (3610, 40)</code></pre>
</div>
</div>
<p>Finally, the resulting merged datasets were saved as separate CSV files:</p>
<ul>
<li><em>pre_covid_merged_titles.csv</em> contains the merged pre-COVID titles.</li>
<li><em>post_covid_merged_titles.csv</em> contains the merged post-COVID titles.</li>
</ul>
<p>This process highlights the focus on aligning Netflix titles with TMDB data to enhance analysis capabilities. The shapes of the resulting datasets were printed to validate the number of titles retained after merging.</p>
</section>
<section id="statistics-and-identifying-common-titles" class="level3">
<h3 class="anchored" data-anchor-id="statistics-and-identifying-common-titles">4. Statistics and Identifying Common Titles</h3>
<p>Now, I need to isolate titles from each merged dataset for detailed comparisons or trend analysis, such as studying the impact of COVID on Netflix’s content library. Also, this is required so that no duplicates are analyzed when analyzing pre-COVID and post-COVID data seperately.</p>
<div id="2259daea" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load pre-COVID dataset</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> pd.read_csv(<span class="st">'pre_covid_merged_titles.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="721e4d79-a489-48a0-81ca-f651034307e4" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load post-COVID dataset</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>post_matching_df <span class="op">=</span> pd.read_csv(<span class="st">'post_covid_merged_titles.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5276ca84-7b8c-4c90-bc9c-22d85aca59af" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find common titles between datasets</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>common_titles <span class="op">=</span> pd.merge(filtered_df, post_matching_df, on<span class="op">=</span><span class="st">'title_lower'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Save common and remaining titles</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>common_titles.to_csv(<span class="st">'common_titles.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Number of common titles: </span><span class="sc">{</span>common_titles<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of common titles: 1484</code></pre>
</div>
</div>
<div id="fdaba84c-b36d-4d4e-974b-b93828d869df" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering out the remaining titles for pre-COVID</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pre_covid_remaining <span class="op">=</span> filtered_df[<span class="op">~</span>filtered_df[<span class="st">'title_lower'</span>].isin(common_titles[<span class="st">'title_lower'</span>])]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>pre_covid_remaining.to_csv(<span class="st">'pre_covid_remaining.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Number of pre-COVID titles: </span><span class="sc">{</span>pre_covid_remaining<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of pre-COVID titles: 2166</code></pre>
</div>
</div>
<div id="1dcfbfc7-0fc3-4f49-a763-6cfec5733966" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering out the remaining titles for post-COVID</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>post_covid_remaining <span class="op">=</span> post_matching_df[<span class="op">~</span>post_matching_df[<span class="st">'title_lower'</span>].isin(common_titles[<span class="st">'title_lower'</span>])]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>post_covid_remaining.to_csv(<span class="st">'post_covid_remaining.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Number of post-COVID titles: </span><span class="sc">{</span>post_covid_remaining<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of post-COVID titles: 2126</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion:</h2>
<p>In this notebook, we successfully prepared and processed two datasets-Netflix and TMDB-to identify common movie titles and explore post-COVID trends. The key steps involved were:</p>
<ul>
<li>Data Loading and Inspection: Reviewed and summarized the datasets, providing an overview of their structure and content.</li>
<li>Data Cleaning and Transformation: Standardized titles, removed duplicates, and ensured consistency for reliable comparisons.</li>
<li>Merging and Filtering: Merged datasets based on movie titles and applied filters to focus on specific timeframes, such as post-COVID releases.</li>
<li>Statistics and Identifying Common Titles Generated key statistics, identified overlaps between datasets, and exported the cleaned and filtered datasets for further analysis. This process not only streamlined the data for easier use but also highlighted important patterns, such as trends in movie releases and shared titles between platforms.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/aravindsankars\.github\.io\/myData_Analysis\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>